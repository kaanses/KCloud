using Microsoft.AspNetCore.Authentication;using Microsoft.AspNetCore.Authentication.Cookies;using System.Security.Claims;using KCloud.Web.Models.DTO;namespace KCloud.Web.Helpers;public static class AuthHelper{    public static async Task SignInUserAsync(HttpContext httpContext, AuthResponseDTO authResponseDTO)    {        var claims = new List<Claim>        {            new(ClaimTypes.NameIdentifier, authResponseDTO.UserId.ToString()),            new(ClaimTypes.Name, authResponseDTO.Username),            new("jwt_token", authResponseDTO.Token),            new("refresh_token", authResponseDTO.RefreshToken)        };        var claimsIdentity = new ClaimsIdentity(claims, CookieAuthenticationDefaults.AuthenticationScheme);                // Get expiry from configuration        var configuration = httpContext.RequestServices.GetRequiredService<IConfiguration>();        var cookieExpiryDays = configuration.GetValue<int>("Authentication:CookieExpiryDays", 7);                var authProperties = new AuthenticationProperties        {            ExpiresUtc = DateTimeOffset.UtcNow.AddDays(cookieExpiryDays)        };        await httpContext.SignInAsync(            CookieAuthenticationDefaults.AuthenticationScheme,            new ClaimsPrincipal(claimsIdentity),            authProperties);    }}